# Vercel 手动部署 API 函数指南

## 当前文件结构（正确）

```
api/
  feishu/
    index.js    ← Serverless Function 文件
```

## 方案 1：使用 Vercel CLI 手动部署（推荐）

### 步骤 1：安装 Vercel CLI（如果还没有）

```bash
# 如果之前安装失败，使用 sudo
sudo npm i -g vercel

# 或者使用 npx（不需要全局安装）
# 直接使用 npx vercel 即可
```

### 步骤 2：登录 Vercel

```bash
npx vercel login
```

### 步骤 3：在项目目录中部署

```bash
cd "/Users/zhaoyuanhao/Documents/cursor/exam index"
npx vercel --prod
```

按照提示操作：
- 选择项目：选择 `exam-index`
- 确认部署：输入 `y`

这会直接将代码部署到 Vercel，不经过 GitHub。

---

## 方案 2：在 Vercel 控制台手动配置

### 步骤 1：进入项目设置

1. 访问 https://vercel.com
2. 进入 `exam-index` 项目
3. 点击 **Settings** → **Functions**

### 步骤 2：检查 Functions 配置

在 Functions 设置页面：
- 查看是否有函数配置
- 如果没有，可能需要通过代码部署

### 步骤 3：手动触发重新部署

1. 进入 **Deployments** 标签
2. 找到最新的部署（即使失败了）
3. 点击右侧的 **"..."** 菜单
4. 选择 **"Redeploy"**
5. 确认重新部署

---

## 方案 3：通过 GitHub 手动触发部署

### 步骤 1：确保代码已提交

```bash
cd "/Users/zhaoyuanhao/Documents/cursor/exam index"
git status
```

### 步骤 2：推送到 GitHub

```bash
git push
```

如果网络问题，可以：
- 稍后重试
- 使用 VPN/代理
- 或者使用方案 1（Vercel CLI）

---

## 方案 4：检查 Vercel 项目设置

### 在 Vercel 控制台：

1. **Settings** → **Build and Deployment**
2. 确保以下设置：
   - **Framework Preset**: `Other`
   - **Build Command**: 留空
   - **Output Directory**: `.` 或留空
   - **Install Command**: 留空

3. **Settings** → **Functions**
   - 检查是否有函数配置
   - 查看 Runtime 设置

---

## 验证部署是否成功

部署完成后：

1. **检查部署状态**
   - 进入 **Deployments** 标签
   - 最新部署应该显示 **"Ready"**（绿色）

2. **检查 Assets**
   - 进入最新部署的详情页
   - 查看 **"Static Assets"** 部分
   - `api/feishu/index.js` 应该**不在**静态资源列表中
   - 应该出现在 **"Serverless Functions"** 或类似部分

3. **检查 Functions 标签页**
   - 在部署详情页顶部导航栏
   - 应该能看到 **"Functions"** 标签页
   - 点击后应该能看到 `/api/feishu` 函数

4. **测试 API**
   - 访问网站并完成答题
   - 打开浏览器开发者工具（F12）→ Network
   - 查看 `/api/feishu` 请求
   - 状态码应该是 **200**，不是 405

---

## 当前配置文件

### vercel.json
```json
{
  "functions": {
    "api/feishu/index.js": {
      "runtime": "nodejs18.x"
    }
  },
  "rewrites": [
    {
      "source": "/((?!api).*)",
      "destination": "/index.html"
    }
  ]
}
```

### api/feishu/index.js
文件已存在，格式正确，使用标准的 `module.exports` 导出。

---

## 如果仍然失败

如果所有方案都失败，请提供：
1. Build Logs 中的具体错误信息
2. 新部署的 Assets 列表截图
3. Functions 标签页是否出现
